# 店舖類型配置模式 - 快速使用指南

## 🎯 什麼是店舖類型配置模式？

這是一個**固定配置**的安全庫存模式，不使用公式計算。根據店舖的「區域」、「等級」和「面積」直接查表獲取安全庫存數量。

## 📋 準備工作

### 1. 確保 CSV 檔案包含以下欄位：

```csv
Article,Site,Class,Last Month Sold Qty,Last 2 Month Sold Qty,Supply Source,MOQ,Original_Safety_Stock,Region,Shop Size
SKU001,HA02,B2,100,150,1,6,10,HK,M
SKU001,HA06,B1,120,180,1,6,12,HK,L
```

**新增必要欄位**:
- `Region`: 區域 (HK 或 MO)
- `Shop Size`: 貨場面積 (XL, L, M, S, XS)

### 2. 檢查店舖等級

確保 `Class` 欄位包含有效值：
- AA, A1, A2, A3 (A 級店舖)
- B1, B2 (B 級店舖)
- C1, C2 (C 級店舖)
- D1 (D 級店舖)

## 🚀 使用步驟

### 步驟 1: 啟動系統

```bash
streamlit run app.py
```

### 步驟 2: 啟用店舖類型配置模式

在左側邊欄找到「**店舖類型配置模式**」區域，勾選：
- ✅ 啟用店舖類型配置模式

### 步驟 3: 上傳資料

1. 點選「**Calculate**」標籤頁
2. 上傳包含 Region 和 Shop Size 欄位的 CSV/Excel 檔案

### 步驟 4: 查看結果

系統會根據配置表自動計算：

**範例結果**:
- 香港 B2 級店舖，M 面積 → 安全庫存 = **12 件**
- 澳門 A1 級店舖，XL 面積 → 安全庫存 = **24 件**

### 步驟 5: 匯出結果

點擊「下載計算結果」按鈕，選擇 Excel 或 CSV 格式。

## 📊 配置表快速參考

### 香港 (HK)

| 店舖等級 | L/XL | M | S/XS |
|---------|------|---|------|
| A 級 | 18 | 18 | 18 |
| B 級 | 18 | 12 | 12 |
| C 級 | 12 | 12 | 0 (XS) |
| D 級 | 9 | 6 | 6 |

### 澳門 (MO)

| 店舖等級 | L/XL | M | S/XS |
|---------|------|---|------|
| A 級 | 24 | 24 | 24 |
| B 級 | 18 | 18 | 12 |
| C 級 | 12 | 12 | 0 (XS) |
| D 級 | 9 | 6 | 6 |

## ⚙️ 常見問題

### Q1: 如果缺少 Region 或 Shop Size 欄位會怎樣？

**A**: 系統會自動退回到標準模式計算，不會影響正常運作。

### Q2: 可以自訂配置表嗎？

**A**: 可以。編輯 `core/constants.py` 中的 `SHOP_TYPE_SS_CONFIG` 字典。

### Q3: 這個模式會影響其他計算模式嗎？

**A**: 不會。此模式完全獨立，啟用時優先使用；停用時系統正常使用其他模式。

### Q4: 如何切換回標準模式？

**A**: 在左側邊欄取消勾選「啟用店舖類型配置模式」即可。

## 🔍 驗證結果

在輸出的 Excel/CSV 中，檢查以下欄位確認使用了店舖類型模式：

- `Calculation_Mode`: 應顯示 "Shop Type Configuration"
- `Constraint_Applied`: 應顯示 "店舖類型配置"
- `Notes`: 會顯示查表詳情

範例:
```
計算步驟（店舖類型模式）：
區域: HK, 店舖等級: B2, 貨場面積: M
查表得到固定安全庫存 = 12
```

## 📞 技術支援

如有任何問題，請參考詳細文檔：
- `plans/v2.5_shop_type_configuration_mode.md`

或執行測試：
```bash
python test_shop_type_mode.py
```
